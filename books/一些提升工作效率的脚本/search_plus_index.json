{"./":{"url":"./","title":"1.1.前言","keywords":"","body":"一些提升工作效率的脚本 简介 在工作中经常会碰到一些繁琐的功能需求，此系列记录一些提升工作效率的脚本。 基本为bash、python脚本，部分代码为原创，因编程功底很差，只实现功能基本需求，未做进一步优化精简。 适用岗位：安全运维、安全服务 离线下载阅读 一些提升工作效率的脚本.pdf 版权和用途说明 此系列文章的全部内容，均为本人整理。其中部分内容从网络摘抄或转载，均已备注了出处。如发现有侵权，请通过邮箱联系我 team@vul.wiki，我会尽快删除。谢谢合作。 各种技术类教程，仅作为学习和研究使用。请勿用于任何非法用途。如有非法用途，均与本人无关。 更多其他系列文章 本人整理多个系列文章，感兴趣可移步至: VUL.WIKI 知识库目录 VUL.WIKI，使用署名4.0国际(CC BY 4.0)协议发布            此页面修订于： 2022-12-09 23:22:07 "},"iptabels自动生成规则.html":{"url":"iptabels自动生成规则.html","title":"1.2.iptabels自动生成规则","keywords":"","body":"iptabels自动编写规则 功能简述 iptables开启日志记录后，会让数据包记录到/var/log/messages，本次通过python脚本将数据包日志分析，生成iptables语法。 准备工作 必须要开启iptabels日志功能，并将/var/log/messages日志保存为log.txt iptables -A INPUT -j LOG --log-prefix=\"iptables-in\" iptables -A OUTPUT -j LOG --log-prefix=\"iptables-out\" 脚本 #!/usr/bin/env python commant_list = [] with open(\"log.txt\",\"r\") as f: l = f.readlines() for i in l: a = (i.split(\" \")) # 分割成列表 if len(a) > 18: # 提高准确度 for _ in a: # 每个字段判断是否为关键字 if \"iptables-out\" in _:TODO = \"OUTPUT\" if \"iptables-in\" in _:TODO = \"INPUT\" if \"SRC\" in _:SRC = _.split('=')[1] if \"DST\" in _:DST = _.split('=')[1] if \"PROTO\" in _:PROTO = _.split('=')[1] if \"SPT\" in _:SPT = _.split('=')[1] if \"DPT\" in _:DPT = _.split('=')[1] commant = \"iptables -I %s -s %s -d %s -p %s --sport %s --dport %s -j ACCEPT\" %(TODO,SRC,DST,PROTO,SPT,DPT) if commant not in commant_list: #去重复 commant_list.append(commant) commant_list.sort() for n in commant_list: print(n) result # › python script.py iptables -I INPUT -s 192.168.1.1 -d 192.168.0.3 -p TCP --sport 8709 --dport 58823 -j ACCEPT iptables -I OUTPUT -s 192.168.1.1 -d 192.168.0.3 -p TCP --sport 40098 --dport 8701 -j ACCEPT iptables -I OUTPUT -s 192.168.1.1 -d 192.168.0.3 -p TCP --sport 40102 --dport 8701 -j ACCEPT iptables -I OUTPUT -s 1192.168.1.1-d 192.168.0.3 -p TCP --sport 40106 --dport 8701 -j ACCEPT iptables -I OUTPUT -s 192.168.1.1 -d 192.168..0.3 -p TCP --sport 40240 --dport 4005 -j ACCEPT iptables -I OUTPUT -s 192.168.1.1 -d 192.168..0.3 -p TCP --sport 40664 --dport 8701 -j ACCEPT VUL.WIKI，使用署名4.0国际(CC BY 4.0)协议发布            此页面修订于： 2022-12-09 23:34:23 "}}